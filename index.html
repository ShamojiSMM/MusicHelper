<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>レール演奏補助ツール</title>

  <link rel="icon" type="image/x-icon" href="images/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon-180x180.png">

  <style>
    body {
      -webkit-text-size-adjust: 100%;
      font-family: Arial, Helvetica, sans-serif;
      white-space: nowrap;
    }

    input[type="number"] {
      height: 30px;
      width: 60px;
    }

    input[type="checkbox"] {
      height: 20px;
      width: 20px;
      position:relative;
      top: 5px;
    }

    select {
      height: 35px;
    }

    button {
      height: 35px;
    }

    .divSet {
      border: 2px solid #12141f;
      background-color: #fffff8;
      white-space: normal;
      font-size: 0.79em;
      margin: 5px;
      margin-top: 10px;
      margin-bottom: 20px;
      border-radius: 15px;
      display: flex;
    }
    
    .divItems {
      display: flex;
      flex-direction: column;
      margin: 7px;
    }

    .imgSet {
      height: 145px;
      display: block;
      margin: 0.5px;
      border-right: 6px solid #4658cd;
      border-radius: 5px;
    }

    .spanData {
      border-bottom: 1px solid #cb4e00;
      width: fit-content;
    }

    .divSkin {
      margin-top: 8px;
      border-bottom: 1px solid #0b4300;
      width: fit-content;
    }

    .imgSkin {
      height: 35px;
      margin-right: 7px;
      border-radius: 6px;
      border: 1.5px solid #176900;
    }

    .imgEnm {
      height: 23px;
      display: inline-block;
      border-radius: 4px;
      border: 0.1px solid #ffffff;
    }

    ul {
      padding-left: 12px;
      margin-top: 0px;
    }
  </style>
</head>

<body>
  <h1>レール演奏補助ツール - SMM2</h1>
  <font size="3">レール演奏に関するいろんな機能があります。</font><br>
  <font size="2">(最終更新日: 2024/02/14)</font>

  <hr>
  <font size="5"><b>目次</b></font>
  <br><br>
  <div style="border: 1px solid #000000; background-color: #f1f1f1; width: 300px;">
    <ol>
      <li><a href="#bpmAndNoteLength">BPMと符長</a></li>
      <li><a href="#measureLength">小節計算</a></li>
      <li><a href="#railLoopGenerator">レールループ生成</a></li>
      <li><a href="#railLoopShape">レールループ周期確認</a></li>
      <li><a href="#tableCulculator">表計算</a></li>
      <li><a href="#wiringGenerator">縦集音配置生成</a></li>
      <li><a href="#imageGallery">画像</a></li>
      <li><a href="#scrollSpeedTable">スクロール遅度表</a></li>
      <li><a href="#grobalGrounds">グローバル音源配置集</a></li>
      <li><a href="#diary">雑記 / 参考文献・資料</a></li>
    </ol>
  </div>

  <hr id="bpmAndNoteLength">
  <font size="5"><b>BPMと符長</b></font>
  <font size="3">レール演奏で必須となる音符の長さを計算。</font>
  <br><br>

  <font size="3"><b>4分符長[f]:</b></font>
  <input type="number" oninput="funBeatLength(this.value)">

  <font size="3"><b>BPM:</b></font>
  <span id="resultBpm"></span>
  <br><br>

  <table border="1" style="border-collapse: collapse; width: 200px; border-color: #9e9e9e" id="tableBeats">
    <tr bgcolor="#cfffff">
      <th>分符</th><th>拍</th><th>記号</th><th>長さ[f]</th>
    </tr>
    <tr align="center">
      <td>1</td><td>4.00</td><td>𝅝</td><td></td>
    </tr>
    <tr align="center">
      <td>符点2</td><td>3.00</td><td>𝅗𝅥.</td><td></td>
    </tr>
    <tr align="center">
      <td>2</td><td>2.00</td><td>𝅗𝅥</td><td></td>
    </tr>
    <tr align="center">
      <td>符点4</td><td>1.50</td><td>𝅘𝅥.</td><td></td>
    </tr>
    <tr align="center" bgcolor="#baffc9">
      <td>4</td><td>1.00</td><td>𝅘𝅥</td><td></td>
    </tr>
    <tr align="center">
      <td>符点8</td><td>0.75</td><td>𝅘𝅥𝅮.</td><td></td>
    </tr>
    <tr align="center">
      <td>8</td><td>0.50</td><td>𝅘𝅥𝅮</td><td></td>
    </tr>
    <tr align="center">
      <td>16</td><td>0.25</td><td>𝅘𝅥𝅯</td><td></td>
    </tr>
    <tr align="center" bgcolor="#ffffe0">
      <td>3</td><td>1.33</td><td>𝅗𝅥𝅗𝅥𝅗𝅥</td><td></td>
    </tr>
    <tr align="center" bgcolor="#ffffe0">
      <td>6</td><td>0.67</td><td>𝅘𝅥𝅘𝅥𝅘𝅥</td><td></td>
    </tr>
    <tr align="center" bgcolor="#ffffe0">
      <td>12</td><td>0.33</td><td>𝅘𝅥𝅮𝅘𝅥𝅮𝅘𝅥𝅮</td><td></td>
    </tr>   
  </table>

  <br>
  <font size="3"><b>BPM:</b></font>
  <input type="number" oninput="funBpm(this.value)">

  <font size="3"><b>4分符長[f]:</b></font>
  <span id="resultBeatLength"></span>
  
  <script>
    var splits = [4, 3, 2, 1.5, 1, 0.75, 0.5, 0.25, (4 / 3), (4 / 6), (4 / 12)];

    function funBeatLength(beatLengthValue) {
      resultBpm.textContent = (3600 / beatLengthValue).toFixed(3);

      for (var tableBeatsRow = 1; tableBeatsRow < tableBeats.rows.length; tableBeatsRow ++) {
        tableBeats.rows[tableBeatsRow].cells[3].textContent = (beatLengthValue * splits[tableBeatsRow - 1]).toFixed(3);
      }
    }

    function funBpm(bpmValue) {
      resultBeatLength.textContent = (3600 / bpmValue).toFixed(3);
    }

  </script>

  <hr id="measureLength">
  <font size="5"><b>小節計算</b></font>
  <font size="3">小節や曲の長さを計算します。</font>
  <br><br>

  <font size="3"><b>4分符長[f]:</b></font>
  <input type="number" id="inputMeasureBeatLength" oninput="funMeasureLength()">

  <font size="3"><b>拍子:</b></font>
  <input type="number" style="width: 35px;" id="inputSignature0" oninput="funMeasureLength()" value="4">
  /
  <input type="number" style="width: 35px;" id="inputSignature1" oninput="funMeasureLength()" value="4">
  <br>
  <font size="3"><b>小節数:</b></font>
  <input type="number" id="inputMeasureNumber" oninput="funMeasureLength()">
  <br><br>
  <font size="3"><b>長さ[f]:</b></font>
  <span id="resultMeasureLength"></span>

  <script>
    function funMeasureLength() {
      if (inputMeasureBeatLength.value != "" && inputSignature0.value != "" && inputSignature0.value != "" && inputMeasureNumber.value != "") {
        resultMeasureLength.textContent = (inputMeasureNumber.value * (inputSignature0.value * ((4 * inputMeasureBeatLength.value) / inputSignature1.value))).toFixed(3);
      
      } else {
        resultMeasureLength.textContent = "";
      }
    }
  </script>
  
  <hr id="railLoopGenerator">
  <font size="5"><b>レールループ生成</b></font>
  <font size="3">レール演奏以外でも使えます。</font>
  <br><br>

  <select id="selectCycleType" onchange="funCycleType(this.selectedIndex)">
    <option>羽あり往復</option>
    <option>羽あり特殊</option>
    <option>羽あり周回</option>
    <option>羽なし往復</option>
  </select>
  
  <font size="3"><b>周期[f]:</b></font>
  <input type="number" id="inputCycle">
  <button onclick="funCycle()">生成</button>
  
  <span id="spanCycleText"><font size="2">( 直線, 斜め, 曲線, うるう距離 )の本数。</font></span>
  <br><br>

  <span id="resultCycle"></span><br>
  <img id="imageCycle" height="150" style="display: none;">

  <script>
    function funCycleType(cycleType) {
      if (cycleType == 1) {
        spanCycleText.style.display = "none";
      
      } else {
        spanCycleText.style.display = "inline-block";
      }
    }


    function funCycle() {
      var cycleLength = parseInt(inputCycle.value);
      var resultCycles = [];

      switch (selectCycleType.selectedIndex) {
        case 0:
          imageCycle.style.display = "none";

          for (var s = 0; s <= cycleLength / 42; s ++) {
            for (var d = 0; d <= cycleLength / 60; d ++) {
              for (var c = 0; c <= cycleLength / 72; c ++) {
                for (var u = 0; u <= s / 3; u ++) {
                  if (s * 42 + d * 60 + c * 72 + u * 2 == cycleLength) {
                    resultCycles.push(` (${s}, ${d}, ${c}, ${u}) `);
                  }
                }
              }
            }
          }

          if (resultCycles.length > 0) {
            resultCycle.textContent = resultCycles.reverse();
          
          } else {
            resultCycle.textContent = "Not Found";
          }
          break;

        case 1:
          var subStraights = [1, 3, 3, 4, 3, 4, 3, 4, 4, 3, 3, 4, 4, 4, 3, 2, 4, 4, 1, 4, 4, 3, 4, 3, 4, 4, 4, 2, 4, 4, 1, 4, 4, 4, 4, 2, 2, 2, 4, 4, 4, 4];
          var addStraights = parseInt(cycleLength / 42) - subStraights[cycleLength % 42];

          if (addStraights >= 0) {
            resultCycle.innerHTML = `<b>直線追加[本]:</b> ${addStraights}`;
            imageCycle.style.display = "block";
            imageCycle.src = `images/tracks/base${cycleLength % 42}.jpg`;

          } else {
            if ([90, 96].includes(cycleLength)) {
              resultCycle.textContent = "";
              imageCycle.style.display = "block";
              imageCycle.src = `images/tracks/other${cycleLength}.jpg`;

            } else {
              resultCycle.textContent = "Not Found";
              imageCycle.style.display = "none";
            }
          }
          break;

        case 2:
          imageCycle.style.display = "none";

          for (var s = 0; s <= cycleLength / 21; s ++) {
            for (var d = 0; d <= cycleLength / 30; d ++) {
              for (var c = 0; c <= cycleLength / 36; c ++) {
                for (var u = 0; u <= s / 3; u ++) {
                  if (s * 21 + d * 30 + c * 36 + u == cycleLength && s % 2 == 0 && cycleLength >= 72) {
                    resultCycles.push(` (${s}, ${d}, ${c}, ${u}) `);
                  }
                }
              }
            }
          }

          if (resultCycles.length > 0) {
            resultCycle.textContent = resultCycles.reverse();
          
          } else {
            resultCycle.textContent = "Not Found";
          }
          break;

        case 3:
          imageCycle.style.display = "none";

          for (var s = 0; s <= cycleLength / 84; s ++) {
            for (var d = 0; d <= cycleLength / 120; d ++) {
              for (var c = 0; c <= cycleLength / 142; c ++) {
                for (var u = 0; u <= s / 2; u ++) {
                  if (s * 84 + d * 120 + c * 142 + u * 2 == cycleLength) {
                    resultCycles.push(` (${s}, ${d}, ${c}, ${u}) `);
                  }
                }
              }
            }
          }

          if (resultCycles.length > 0) {
            resultCycle.textContent = resultCycles.reverse();

          } else {
            resultCycle.textContent = "Not Found";
          }
      }
    }
  </script>

  <hr id="railLoopShape">
  <font size="5"><b>レールループ周期確認</b></font>
  <font size="3">断線は未実装です。</font>
  <br><br>

  <select id="selectShape">
    <option>羽あり往復</option>
    <option>羽あり周回</option>
    <option>羽なし往復</option>
    <option>羽なし周回</option>
  </select>
  <font size="3"><b>:</b></font>
  <button onclick="funShape()">確認</button><br>

  <font size="3"><b>直線[本]:</b></font>
  <input type="number" id="inputShapeStraight">

  <font size="3"><b>斜め[本]:</b></font>
  <input type="number" id="inputShapeDiagonal">

  <font size="3"><b>曲線[本]:</b></font>
  <input type="number" id="inputShapeCurved">

  <font size="3"><b>うるう[本]:</b></font>
  <input type="number" id="inputShapeCorrection">
  <br><br>
  <font size="3"><b>周期[f]:</b></font>
  <span id="resultShape"></span>

  <script>
    function funShape() {
      var straight = parseInt(inputShapeStraight.value);
      var diagonal = parseInt(inputShapeDiagonal.value);
      var curved = parseInt(inputShapeCurved.value);
      var correction = parseInt(inputShapeCorrection.value);
    
      switch (selectShape.selectedIndex) {
        case 0:
          resultShape.textContent = (42 * straight + 60 * diagonal + 72 * curved + 2 * correction);
          break;

        case 1:
          resultShape.textContent = (21 * straight + 30 * diagonal + 36 * curved + 1 * correction);
          break;

        case 2:
          resultShape.textContent = (84 * straight + 120 * diagonal + 142 * curved + 2 * correction);
          break;

        case 3:
          resultShape.textContent = (42 * straight + 60 * diagonal + 71 * curved + 1 * correction);
      }
    }
  </script>

  <hr id="tableCulculator">
  <font size="5"><b>表計算</b></font>
  <font size="3">縦断線式集音に必要な計算をします。<a href="https://www.youtube.com/watch?v=DFh_rsFVZ8c">解説動画</a></font>
  <br><br>

  <font size="3"><b>読み込みタイプ:</b></font>
  <select id="selectLoading" onchange="funLoading(this.selectedIndex)">
    <option>開始画面(全て同時)</option>
    <option>自由落下</option>
    <option>縦スクロール</option>
    <option>横スクロール</option>
  </select>

  <select style="display: none;" id="selectLoadingSpeedInput" onchange="funLoadingSpeedInput(this.selectedIndex)">
    <option>カスタム</option>
    <option selected="true">平均遅度</option>
    <option>遅度周期</option>
  </select>
  <br>
  <div style="display: none;" id="divLoadingSpeedAverage">
    <font size="3"><b>平均スクロール遅度[f/b]:</b></font>
    <input type="number" id="inputLoadingSpeedAverage" oninput="funLoadingSpeedAverage(this.value)">
    <font size="2">上向き, 右向きを正とする(自由落下 = -4)。</font>
  </div>

  <div style="display: none;" id="divLoadingSpeedCycle">
    <font size="3"><b>スクロール遅度周期[f/b]:</b></font>
    <input type="text" id="inputLoadingSpeedCycle" style="height: 35px; width: 200px;" oninput="funLoadingSpeedCycle(this.value)">
    <font size="2">値をコンマ区切りで入力(例: 6, 7, 6, 7, 6)。</font>
  </div>
  
  <font size="3"><b>着線パターン:</b></font>
  <select id="selectLanding" onchange="funLanding(this.selectedIndex)">
    <option>カスタム</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
  </select>
  <br>
  <font size="3"><b>4分符長[f]: </b></font>
  <input type="number" id="inputTableBeat" oninput="funTableBeat(this.value)">

  <font size="3"><b>BPM: </b><span id="resultTableBpm"></span></font>
  <br><br>
  <font size="3"><b>基準音階:</b></font>
  <select id="selectScale">
    <option>HiD# 高レ#</option>
    <option>HiD 高レ</option>
    <option>HiC# 高ド#</option>
    <option style="color: #ff8045;">HigC 高ド</option>
    <option>MidB 中シ</option>
    <option>MidA# 中ラ#</option>
    <option>MidA 中ラ</option>
    <option>MidG# 中ソ#</option>
    <option>MidG 中ソ</option>
    <option>MidF# 中ファ#</option>
    <option>MidF 中ファ</option>
    <option>MidE 中ミ</option>
    <option>MidD# 中レ#</option>
    <option>MidD 中レ</option>
    <option>MidC# 中ド#</option>
    <option style="color: #26e100;" selected>MidC 中ド</option>
    <option>LowB 低いシ</option>
    <option>LowA# 低ラ#</option>
    <option>LowA 低ラ</option>
    <option>LowG# 低ソ#</option>
    <option>LowG 低ソ</option>
    <option>LowF# 低ファ#</option>
    <option>LowF 低ファ</option>
    <option>LowE 低ミ</option>
    <option>LowD# 低レ#</option>
    <option>LowD 低レ</option>
    <option>LowC# 低ド#</option>
    <option style="color: #5d78ff;">LowC 低ド</option>
  </select>
  <button onclick="funPlay()">鳴らす</button>
  
  <font size="3"><b>音色:</b></font>
  <select id="selectInstrument">
    <option>正弦波</option>
    <option>三角波</option>
    <option>矩形波</option>
    <option>ノコギリ波</option>
  </select>
  
  <div style="overflow-x: scroll;">
    <table id="tableWiring" border="1" style="width: 6000px; border-collapse: collapse; table-layout: fixed;">
      <tr bgcolor="#ffffe0">
        <th bgcolor="#dcdcdc" width="1.60%">番号</th><th>01</th>
      </tr>
      <tr bgcolor="#ffffff">
        <th bgcolor="#dcdcdc">メモ</th><td contenteditable="true"></td>
      </tr>
      <tr bgcolor="#ffffff">
        <th bgcolor="#dcdcdc">n分符</th><td contenteditable="true" oninput="funNote()"></td>
      </tr>
      <tr bgcolor="#fffff7">
        <th bgcolor="#dcdcdc">符長[f]</th><td contenteditable="true"></td>
      </tr>
      <tr bgcolor="#fffff7">
        <th bgcolor="#dcdcdc">xズレ[f]</th><td>0</td>
      </tr>
      <tr bgcolor="#fffff7" style="display: none;">
        <th bgcolor="#dcdcdc">横スク遅延[f]</th><td>0</td>
      </tr>
      <tr bgcolor="#fffff7">
        <th bgcolor="#dcdcdc">yズレ[b]</th><td>0</td>
      </tr>
      <tr bgcolor="#f0ffff">
        <th bgcolor="#afeeee">結果[f]</th><td style="border: 2px solid #303030;" contenteditable="true" oninput="funTable()"></td>
      </tr>
      <tr bgcolor="#fff2e9">
        <th bgcolor="#ffc0cb">高さ[b]</th><td style="border: 2px solid #303030;" contenteditable="true" oninput="funTable()"></td>
      </tr>
      <tr bgcolor="#ffffff">
        <th bgcolor="#dcdcdc">配置</th><td></td>
      </tr>
      <tr>
        <th bgcolor="#dcdcdc">代入</th>
      </tr>
    </table>
  </div>

  <font size="3"><b>遅延入力方法:</b></font>
  <select id="selectInputType" onchange="funInputType(this.selectedIndex)">
    <option>それぞれの符長</option>
    <option>累計遅延</option>
  </select>

  <font size="2"><span id="spanInputType">n分符には, 4+8, 16+16, 2-32のように入力可(付点4分, 8分, 4分+8分+16分+32分)。</span></font>
  <br>
  <button onclick="funTable()">更新</button>
  <br>
  <button onclick="funTest()">検証</button>
  <font size="2">結果が配置可能かどうかを検証。(◎一致, ○誤差, △もっと誤差, ×不可)</font>
  <br>
  <font size="2">個数: [
    ◎: <span id="testResult0"></span>
    ○: <span id="testResult1"></span>
    △: <span id="testResult2"></span>
    ×: <span id="testResult3"></span>
    ]</font>
  <br>
  <input type="checkbox" id="checkTestTerminal">
  <font size="2">終端遅度を使用(8b以上あける)。</font><br>
  <font size="2">代入ボタンで↓に結果を代入・表示します。</font>

  <script>
    for (var generateColumn = 1; generateColumn <= 100; generateColumn ++) {
      var generateButton = document.createElement("button");
      generateButton.style = "width: 50px; height: 25px;";
      generateButton.addEventListener("click", funTableButton);
      generateButton.id = generateColumn;

      var generateRow10 = tableWiring.rows[10].insertCell(generateColumn);
      generateRow10.style.textAlign = "center";
      generateRow10.style.varticalAlign = "middle";
      generateRow10.appendChild(generateButton);

      if (generateColumn >= 2) {
        var generateRow0 = document.createElement("th");
        generateRow0.textContent = generateColumn <= 9 ? `0${generateColumn}` : generateColumn;
        tableWiring.rows[0].appendChild(generateRow0);

        var generateRow2 = tableWiring.rows[2].insertCell(generateColumn);
        generateRow2.contentEditable = true;
        generateRow2.addEventListener("input", funNote);

        for (var i = 1; i <= 9; i ++) {
          if (i == 2) continue;

          if (i <= 6) {
            tableWiring.rows[i].insertCell(generateColumn).contentEditable = true;
          
          } else {
            tableWiring.rows[i].insertCell(generateColumn);
          }
        }
      }
    }

    function funInputType(selectedIndex) {
      if (selectedIndex == 0) {
        tableWiring.rows[2].style.display = "table-row";
        tableWiring.rows[3].cells[0].textContent = "符長[f]";

        spanInputType.style.display = "inline-block";

      } else {
        tableWiring.rows[2].style.display = "none";
        tableWiring.rows[3].cells[0].textContent = "累計遅延[f]";

        spanInputType.style.display = "none";
      }
    }

    function funTableBeat(tableBeatValue) {
      resultTableBpm.textContent = (3600 / tableBeatValue).toFixed(3);

      if (selectInputType.selectedIndex == 0) {
        for (var beatColumn = 1; beatColumn <= 100; beatColumn ++) {
          if (!isNaN(tableWiring.rows[2].cells[beatColumn].textContent)) {
            tableWiring.rows[3].cells[beatColumn].textContent = isFinite(((parseFloat(inputTableBeat.value) * 4) / tableWiring.rows[2].cells[beatColumn].textContent).toFixed(3)) ? ((parseFloat(inputTableBeat.value) * 4) / tableWiring.rows[2].cells[beatColumn].textContent).toFixed(3) : "";

          } else {
            var sumNotes = ((tableWiring.rows[2].cells[beatColumn].textContent).split("+").map(Number)).map(note => (parseFloat(inputTableBeat.value) * 4) / note).reduce((a, b) => a + b, 0);

            tableWiring.rows[3].cells[beatColumn].textContent = isFinite(sumNotes) ? sumNotes.toFixed(3) : "";
          }
        }
      }
    }

    function funNote() {
      if (selectInputType.selectedIndex == 0) {
        if (!isNaN(tableWiring.rows[2].cells[event.target.cellIndex].textContent)) {
          tableWiring.rows[3].cells[event.target.cellIndex].textContent = isFinite(((parseFloat(inputTableBeat.value) * 4) / event.target.textContent).toFixed(3)) ? ((parseFloat(inputTableBeat.value) * 4) / event.target.textContent).toFixed(3) : "";

        } else {
          var parts = event.target.textContent.split(/([+-])/);
          var calNotes = 0;

          for (var i = 0; i < parts.length; i += 2) {
            var sign = i > 0 ? parts[i - 1] : "";

            var note = (inputTableBeat.value * 4 / parseFloat(parts[i]));
            calNotes += parseFloat(sign + note);
          }

          tableWiring.rows[3].cells[event.target.cellIndex].textContent = isFinite(calNotes) ? calNotes.toFixed(3) : "";
        }
      }
    }

    function funLoading(selectedIndex) {
      divLoadingSpeedCycle.style.display = "none";

      switch (selectedIndex) {
        case 0:
        case 1:
          divLoadingSpeedAverage.style.display = "none";
          selectLoadingSpeedInput.style.display = "none";

          tableWiring.rows[5].style.display = "none";
          break;

        case 2:
          divLoadingSpeedAverage.style.display = "block";
          selectLoadingSpeedInput.style.display = "none";

          tableWiring.rows[5].style.display = "none";
          break;
        
        case 3:
          divLoadingSpeedAverage.style.display = "block";
          selectLoadingSpeedInput.style.display = "inline-block";
          selectLoadingSpeedInput.selectedIndex = 1;

          tableWiring.rows[5].style.display = "table-row";
      }
    }

    function funLoadingSpeedInput(selectedIndex) {
      switch (selectedIndex) {
        case 0:
          divLoadingSpeedAverage.style.display = "none";
          divLoadingSpeedCycle.style.display = "none";
          break;

        case 1: 
          divLoadingSpeedCycle.style.display = "none";
          divLoadingSpeedAverage.style.display = "block";
          break;

        case 2:
          divLoadingSpeedAverage.style.display = "none";
          divLoadingSpeedCycle.style.display = "block";
      }
    }

    function funLanding(selectedIndex) {
      var firstCorrection = "";
      var correctionPattern = [];

      switch (selectedIndex) {
        case 1:
          firstCorrection = 8;
          correctionPattern = [11, 11, 10];
          break;
        
        case 2:
          firstCorrection = 11;
          correctionPattern = [11, 10, 11];
          break;

        case 3:
          firstCorrection = 11;
          correctionPattern = [10, 11, 11];
          break;

        case 4:
          firstCorrection = 10;
          correctionPattern = [11, 11, 10];
      }

      for (var landingColumn = 2; landingColumn <= 100; landingColumn ++) {
        if (landingColumn == 2) {
          tableWiring.rows[4].cells[2].textContent = firstCorrection;

        } else {
          tableWiring.rows[4].cells[landingColumn].textContent = correctionPattern[landingColumn % 3];
        }
      }
    }

    function funLoadingSpeedAverage(loadingSpeedValue) {
      if (selectLoading.selectedIndex == 3) {
        if (loadingSpeedValue != "") {
          for (var loadingSpeedColumn = 2; loadingSpeedColumn <= 100; loadingSpeedColumn ++) {
            tableWiring.rows[5].cells[loadingSpeedColumn].textContent = parseFloat(loadingSpeedValue).toFixed(3);
          }

        } else {
          for (var deleteLoadingSpeedColumn = 2; deleteLoadingSpeedColumn <= 100; deleteLoadingSpeedColumn ++) {
            tableWiring.rows[5].cells[deleteLoadingSpeedColumn].textContent = "";
          }
        }
      }
    }

    function funLoadingSpeedCycle(loadingSpeeds) {
      if (selectLoading.selectedIndex == 3) {
        var loadingSpeedValues = loadingSpeeds.split(",").map(speed => parseFloat(speed.trim(), 10));

        for (var loadingSpeedsColumn = 2; loadingSpeedsColumn <= 100; loadingSpeedsColumn ++) {
          tableWiring.rows[5].cells[loadingSpeedsColumn].textContent = (loadingSpeedValues[(loadingSpeedsColumn - 2) % loadingSpeedValues.length]).toFixed(3);
        }
      }
    }

    tableWiring.addEventListener("keydown", function(e) {
      if (e.ctrlKey) {
        var row = document.activeElement.parentNode.rowIndex;
        var cell = document.activeElement.cellIndex;

        switch (e.key) {
          case "ArrowRight":
            tableWiring.rows[row].cells[cell + 1].focus();
            break;

          case "ArrowLeft":
            tableWiring.rows[row].cells[cell - 1].focus();
            tableWiring.rows[row].cells[cell - 1].textContent += ""; 
            break;

          default:
            if (selectLoading.selectedIndex == 3) {
              if (selectInputType.selectedIndex == 1) {
                switch (e.key) {
                  case "ArrowUp":
                    tableWiring.rows[row - (row == 3 ? 2 : 1)].cells[cell].focus();
                    break;
                  
                  case "ArrowDown":
                    tableWiring.rows[row + (row == 1 ? 2 : 1)].cells[cell].focus();
                }

              } else {
                switch (e.key) {
                  case "ArrowUp":
                    tableWiring.rows[row - 1].cells[cell].focus();
                    break;
                  
                  case "ArrowDown":
                    tableWiring.rows[row + 1].cells[cell].focus();
                }
              }
              
            } else {
              if (selectInputType.selectedIndex == 1) {
                switch (e.key) {
                  case "ArrowUp":
                    tableWiring.rows[row - (row == 3 || row == 6 ? 2 : 1)].cells[cell].focus();
                    break;
                  
                  case "ArrowDown":
                    tableWiring.rows[row + (row == 1 || row == 4 ? 2 : 1)].cells[cell].focus();
                }

              } else {
                switch (e.key) {
                  case "ArrowUp":
                    tableWiring.rows[row - (row == 6 ? 2 : 1)].cells[cell].focus();
                    break;
                  
                  case "ArrowDown":
                    tableWiring.rows[row + (row == 4 ? 2 : 1)].cells[cell].focus();
                }
              }
            }   
        }
      }
    });

    function funSleep(f) {
      return new Promise(resolve => setTimeout(resolve, f * 50 / 3));
    } 

    var instruments = ["sine", "triangle", "square", "sawtooth"];

    var audioContext = new (window.AudioContext || window.webkitAudioContext)();
    
    function funPlaySound(column) {
      var oscillator = audioContext.createOscillator();
      var gainNode = audioContext.createGain();

      oscillator.type = instruments[selectInstrument.selectedIndex];
      oscillator.frequency.setValueAtTime(440 * (2 ** ((18 - selectScale.selectedIndex + parseFloat(tableWiring.rows[6].cells[column].textContent)) / 12)), audioContext.currentTime);
      oscillator.connect(gainNode);      

      gainNode.gain.value = 0.2;     
      gainNode.connect(audioContext.destination);

      oscillator.start();
      oscillator.stop(audioContext.currentTime + 0.1);
    }

    function funPlay() {
      if (selectInputType.selectedIndex == 0) {
        (async () => {
          for (var playColumn = 1; playColumn <= 100; playColumn ++) {
            if (tableWiring.rows[3].cells[playColumn].textContent + tableWiring.rows[6].cells[playColumn].textContent == "" || playColumn >= 100) {
              for (var playLightColumn of tableWiring.rows[0].cells) {
                if (playLightColumn.cellIndex >= 1) {
                  playLightColumn.style.backgroundColor = "#ffffe0";
                }
              }
              break;
            }
    
            if (!isNaN(tableWiring.rows[6].cells[playColumn].textContent)) {
              funPlaySound(playColumn);
            }
    
            if (playColumn >= 2) {
              tableWiring.rows[0].cells[playColumn - 1].style.backgroundColor = "#ffffe0";
            }
            tableWiring.rows[0].cells[playColumn].style.backgroundColor = "#98fb98";
    
            await funSleep(parseFloat(tableWiring.rows[3].cells[playColumn].textContent));
          }
        })();

      } else {
        for (var playResetColumn of tableWiring.rows[0].cells) {
          if (playResetColumn.cellIndex >= 1) {
            playResetColumn.style.backgroundColor = "#ffffe0";
          }
        }

        for (var playColumn = 1; playColumn <= 100; playColumn ++) {
          if (!isNaN(parseFloat(tableWiring.rows[3].cells[playColumn].textContent) + parseInt(tableWiring.rows[6].cells[playColumn].textContent)) && tableWiring.rows[3].cells[playColumn].textContent != "" && tableWiring.rows[6].cells[playColumn].textContent != "") {
            const playCell = playColumn;

            setTimeout(() => {
              for (var playLightColumn of tableWiring.rows[0].cells) {
                if (playLightColumn.cellIndex >= 1 && playCell >= 2) {
                  playLightColumn.style.backgroundColor = "#ffffe0";
                }
              }
              tableWiring.rows[0].cells[playCell].style.backgroundColor = "#98fb98";

              funPlaySound(playColumn);

            }, parseFloat(tableWiring.rows[3].cells[playCell].textContent) * 50 / 3);
          }
        }
      }
    }

    function funTable() {
      var totalNoteDelay = 0;
      var totalXDelay = 0;
      var yLoadingSpeed = 0;

      switch (selectLoading.selectedIndex) {
        case 1:
          yLoadingSpeed = -4;
          break;

        case 2:
          yLoadingSpeed = inputLoadingSpeedAverage.value;
      }

      for (var tableColumn = 2; tableColumn <= 100; tableColumn ++) {
        totalNoteDelay = selectInputType.selectedIndex == 0 ? (totalNoteDelay + (tableColumn != 1 ? parseFloat(tableWiring.rows[3].cells[tableColumn - 1].textContent) : 0)) : parseFloat(tableWiring.rows[3].cells[tableColumn].textContent);
        totalXDelay += parseFloat(tableWiring.rows[4].cells[tableColumn].textContent) + (selectLoading.selectedIndex == 3 ? parseFloat(tableWiring.rows[5].cells[tableColumn].textContent) : 0);

        tableWiring.rows[7].cells[tableColumn].textContent = parseInt(parseInt(tableWiring.rows[7].cells[1].textContent) + totalNoteDelay - totalXDelay - ((selectLoading.selectedIndex != 1 ? parseInt(tableWiring.rows[6].cells[tableColumn].textContent) : 0) * (yLoadingSpeed + 4)));

        tableWiring.rows[8].cells[tableColumn].textContent = parseInt(tableWiring.rows[8].cells[1].textContent) + parseInt(tableWiring.rows[6].cells[tableColumn].textContent);
      }
    }    

    function funTest() {
      var testResults = [0, 0, 0, 0];

      for (var testColumn = 1; testColumn <= 100; testColumn ++) {
        var target = parseInt(tableWiring.rows[7].cells[testColumn].textContent);
        var height = (checkTestTerminal.checked ? 15 : parseInt(tableWiring.rows[8].cells[testColumn].textContent) - 1);
        var resultSame = [], resultNear = [], resultNearNear = [];

        if (!isNaN(target) && !isNaN(height) && target + height != "") {
          for (var i = 0; i < startingList.length; i ++) {
            var starting = startingList[i];

            if (starting.delay <= target + 11 && starting.height <= height) {
              for (var j = 0; j < gapList.length; j ++) {
                var gap0 = gapList[j];
    
                for (var k = 0; k < gapList.length; k ++) {
                  var gap1 = gapList[k];
    
                  for (var l = 0; l < gapList.length; l ++) {
                    var gap2 = gapList[l];
                    var totalHeight = starting.height + gap0.height + gap1.height + gap2.height;
                    var distance = height - totalHeight;
    
                    if (distance >= 0) {
                      var totalDelay = starting.delay + gap0.delay + gap1.delay + gap2.delay - (checkTestTerminal.checked ? 0 : (distance <= 6 ? accelerations[distance] : 0));
                      var targetResult = {delay: totalDelay, height: starting.height + gap0.height + gap1.height + gap2.height, display: starting.display + gap0.display + gap1.display + gap2.display};
    
                      switch (totalDelay) {
                        case target:
                          resultSame.push(targetResult);
                          break;
    
                        case target + 1:
                        case target - 1:
                          resultNear.push(targetResult);
                          break;
    
                        case target + 2:
                        case target - 2:
                          resultNearNear.push(targetResult);
                      }
                    }
                  }
                }
              }
            }
          }

          if (resultSame.length > 0) {
            tableWiring.rows[9].cells[testColumn].textContent = "◎";
            testResults[0] += 1;

          } else if (resultNear.length > 0) {
            tableWiring.rows[9].cells[testColumn].textContent = "○";
            testResults[1] += 1;

          } else if (resultNearNear.length > 0) {
            tableWiring.rows[9].cells[testColumn].textContent = "△";
            testResults[2] += 1;

          } else {
            tableWiring.rows[9].cells[testColumn].textContent = "×";
            testResults[3] += 1;
          }
         
        } else {
          tableWiring.rows[9].cells[testColumn].textContent = "";
        }
      }

      for (var i = 0; i <= 3; i ++) {
        document.getElementById("testResult" + i).textContent = testResults[i];
      }
    }

    function funTableButton(button) {
      inputTarget.value = tableWiring.rows[7].cells[button.target.id].textContent;
      inputHeight.value = tableWiring.rows[8].cells[button.target.id].textContent;
      funTarget();

      for (tableButtonColumn = 1; tableButtonColumn <= 100; tableButtonColumn ++) {
        document.getElementById(tableButtonColumn).style.backgroundColor = "";
      }
      button.target.style.backgroundColor = "#a8fb98";
    }
  </script>

  <hr id="wiringGenerator">
  <font size="5"><b>縦集音配置生成</b></font>
  <font size="3">縦レールによる集音(ぜんまいメソッド)の配置を探します。</font>
  <br><br>

  <font size="3"><b>狙いの値[f]:</b></font>
  <input type="number" id="inputTarget">

  <span id="spanHeight">
    <font size="3"><b>着線レールとの距離[b]:</b></font>
    <input type="number" id="inputHeight">
  </span>

  <button onclick="funTarget()">探す</button><br>
  <input type="checkbox" id="checkTerminal" onclick="funTerminal()">
  <font size="2">終端遅度を使用(8b以上あける)。<br></font>
  <select id="selectSort" onchange="funSort()">
    <option>↓長さ 短い順</option>
    <option>↓長さ 長い順</option>
    <option>↑長さ 短い順</option>
    <option>↑長さ 長い順</option>
  </select>
  <font size="2">( 遅延 / ↓長さ / ↑長さ / 表記 )。</font>
  <br><br>

  <font size="3"><b>一致:</b></font><br>
  <span id="resultSame"></span><br>

  <font size="3"><b>誤差:</b></font><br>
  <span id="resultNear"></span><br>

  <font size="3"><b>もっと誤差:</b></font><br>
  <span id="resultNearNear"></span> 

  <script>
    function funTerminal() {
      spanHeight.style.display = (checkTerminal.checked ? "none" : "inline-block");
    }

    function funTarget() {
      resultSame = [], resultNear = [], resultNearNear = [];

      var target = parseInt(inputTarget.value);
      var height = (checkTerminal.checked ? 15 : parseInt(inputHeight.value) - 1);

      for (var i = 0; i < startingList.length; i ++) {
        var starting = startingList[i];

        if (starting.delay <= target + 11 && starting.height <= height) {
          for (var j = 0; j < gapList.length; j ++) {
            var gap0 = gapList[j];

            for (var k = 0; k < gapList.length; k ++) {
              var gap1 = gapList[k];

              for (var l = 0; l < gapList.length; l ++) {
                var gap2 = gapList[l];
                var totalHeight = starting.height + gap0.height + gap1.height + gap2.height;
                var distance = height - totalHeight;

                if (distance >= 0) {
                  var totalDelay = starting.delay + gap0.delay + gap1.delay + gap2.delay - (checkTerminal.checked ? 0 : (distance <= 6 ? accelerations[distance] : 0));
                  var targetResult = {delay: totalDelay, height: starting.height + gap0.height + gap1.height + gap2.height, up: starting.up, display: `${starting.display}${gap0.display}${gap1.display}${gap2.display}`};

                  switch (totalDelay) {
                    case target:
                      resultSame.push(targetResult);
                      break;

                    case target + 1: 
                    case target - 1:
                      resultNear.push(targetResult);
                      break;

                    case target + 2:
                    case target - 2:
                      resultNearNear.push(targetResult);
                  }
                }
              }
            }
          }
        }  
      }

      funSort();
    }

    function funSort() {
      switch (selectSort.selectedIndex) {
        case 0:
          resultSame.sort((m, n) => m.height - n.height);
          resultNear.sort((m, n) => m.height - n.height);
          resultNearNear.sort((m, n) => m.height - n.height);
          break;

        case 1:
          resultSame.sort((m, n) => n.height - m.height);
          resultNear.sort((m, n) => n.height - m.height);
          resultNearNear.sort((m, n) => n.height - m.height);
          break;

        case 2:
          resultSame.sort((m, n) => m.up - n.up);
          resultNear.sort((m, n) => m.up - n.up);
          resultNearNear.sort((m, n) => m.up - n.up);
          break;

        case 3:
          resultSame.sort((m, n) => n.up - m.up);
          resultNear.sort((m, n) => n.up - m.up);
          resultNearNear.sort((m, n) => n.up - m.up);
      }

      var newResultSame = [], newResultNear = [], newResultNearNear = [];

      resultSame.forEach(result => {
        newResultSame.push(` (${result.delay}/${result.height}/${result.up}/${result.display}) `);
      });
      resultNear.forEach(result => {
        newResultNear.push(` (${result.delay}/${result.height}/${result.up}/${result.display}) `);
      });
      resultNearNear.forEach(result => {
        newResultNearNear.push(` (${result.delay}/${result.height}/${result.up}/${result.display}) `);
      });

      document.getElementById("resultSame").innerHTML = Array.from(new Set(newResultSame));
      document.getElementById("resultNear").innerHTML = Array.from(new Set(newResultNear));
      document.getElementById("resultNearNear").innerHTML = Array.from(new Set(newResultNearNear));
    }
  </script>

  <hr id="imageGallery">
  <font size="5"><b>画像</b></font>
  <br><br>
  <img src="images/info/loop.jpg" height="180">
  <br>
  <img src="images/info/gaps.jpg" height="140">
  <img src="images/info/height.jpg" height="140">
  <br>
  <img src="images/info/landing.jpg" height="180">

  <hr id="scrollSpeedTable">
  <font size="5"><b>スクロール遅度表</b></font>
  <font size="2"><a href="https://www.youtube.com/watch?v=3VlLrf_5KvA">一部参考</a></font><br>
  <font size="2">数値の単位は[f/b], 1b進むのにかかる時間。</font>

  <table border="1" style="border-collapse: collapse;">
    <tr style="background-color: #ffffd1;">
      <th rowspan="100" style="background-color: #d5ffd2;">横</th><th>スクロール方法</th><th>平均遅度</th><th>周期</th>
    </tr>
    <tr style="background-color: #f1f1f1;">
      <td>強制(遅), クリボー</td><td>32.00</td><td>32...</td>
    </tr>
    <tr style="background-color: #f1f1f1;">
      <td>強制(中), コンベア(中)</td><td>16.00</td><td>16...</td>
    </tr>
    <tr style="background-color: #f1f1f1;">
      <td>強制(速), コンベア(速)</td><td>8.00</td><td>8...</td>
    </tr>
    <tr style="background-color: #ffffff;">
      <td>青ドクロ, コンベア(中)+歩き, コンベア(速)+クリボー</td><td>6.40</td><td>6, 6, 7, 6, 7...</td>
    </tr>
    <tr style="background-color: #f1f1f1;">
      <td>走り, ドッスン</td><td>5.33</td><td>5, 5, 6...</td>
    </tr>
    <tr style="background-color: #f1f1f1;">
      <td>歩き, 羽レールブロック</td><td>10.66</td><td>10, 11, 11...</td>
    </tr>
    <tr style="background-color: #f1f1f1;">
      <td>レールブロック</td><td>21.33</td><td>21, 21, 22...</td>
    </tr>
    <tr style="background-color: #ffffff;">
      <td>コンベア(速)+走り</td><td>3.20</td><td>3, 3, 3, 3, 4...</td>
    </tr>
    <tr style="background-color: #ffffff;">
      <td>コンベア(中)+走り</td><td>4.00</td><td>4...</td>
    </tr>
    <tr style="background-color: #ffffff;">
      <td>コンベア(速)+歩き</td><td>4.57</td><td>4, 5, 4, 5, 4, 5, 5...</td>
    </tr>
    <tr style="background-color: #f1f1f1;">
      <td>コンベア(速)+チョロプー</td><td>4.33 (終端)</td><td>(16, 7, 7, 6, 6, 6, 6, 5, 6, 5, 5, 4, 5, 5, ) 4, 5, 4...</td>
    </tr>
    <tr style="background-color: #f1f1f1;">
      <td>コンベア(速)+怒ハナチャン</td><td>5.00</td><td>5...</td>
    </tr>
    <tr style="background-color: #f1f1f1;">
      <td>コンベア(速)+青トゲメット</td><td>5.83</td><td>5, 6, 6, 6, 6, 6...</td>
    </tr>
    <tr style="background-color: #ffffff;">
      <td>赤砲台メット</td><td>3.60</td><td>3, 4, 3, 4, 4...</td>
    </tr>
    <tr style="background-color: #ffffff;">
      <td>コンベア(中)+赤砲台メット</td><td>3.00</td><td>3...</td>
    </tr>
    <tr style="background-color: #ffffff;">
      <td>コンベア(速)+赤砲台メット</td><td>2.50</td><td>2, 3...</td>
    </tr>
  </table><br>

  <table border="1" style="border-collapse: collapse;">
    <tr style="background-color: #ffffd1;">
      <th rowspan="100" style="background-color: #d5ffd2;">縦</th><th>スクロール方法</th><th>平均遅度</th><th>周期</th>
    </tr>
    <tr style="background-color: #ffffff;">
      <td>↓自由落下</td><td>4.00</td><td>4...</td>
    </tr>
    <tr style="background-color: #ffffff;">
      <td>↓デブロス落下</td><td>2.00</td><td>2...</td>
    </tr>
    <tr style="background-color: #f1f1f1;">
      <td>↑ブンブン急上昇</td><td>5.33</td><td>5, 5, 6...</td>
    </tr>
  </table>

  <hr id="grobalGrounds">
  <font size="5"><b>グローバル音源配置集</b></font>
  <font size="3">グローバル音源を集めました。</font>
  <br><br>

  <font size="2">羽あり音符の往復型ループ端点で音源と接触して1回だけ音を鳴らすような配置。もしくは単に便利そうな音源。<br>
  コストは音源エネミーを除いた必要ELAの値。<br>
  ここでは複数の音源を同時に鳴らすことを"複合"と呼ぶ。</font>
  <br><br>
  <div id="divSetsParent"></div>

  <script>
    window.onload = function() {
      for (var i = 0; i < sets.length; i ++) {
        var divSet = document.createElement("div");
        divSet.classList = "divSet";
        divSetsParent.appendChild(divSet);

        var divImgs = document.createElement("div");
        divImgs.classList = "divItems";
        divSet.appendChild(divImgs);
        
        ["a", "b"].forEach(e => {
          var imgSet = document.createElement("img");
          imgSet.classList = "imgSet";
          imgSet.src = `images/sets/set${i}${e}.jpg`;
          divImgs.appendChild(imgSet);
        });

        var divTexts = document.createElement("div");
        divTexts.classList = "divItems";
        divSet.appendChild(divTexts);

        var spanData = document.createElement("span");
        spanData.textContent = `コスト: ${sets[i].cost}, 複合: ${sets[i].combine ? "○" : "×"}`;
        spanData.classList = "spanData";
        divTexts.appendChild(spanData);

        var spanNote = document.createElement("span");
        spanNote.textContent = sets[i].note;
        divTexts.appendChild(spanNote);

        for (var skin = 0; skin < 4; skin ++) {
          var divSkin = document.createElement("div");
          divSkin.id = `divSkin${skin}`;
          divSkin.classList = "divSkin";
          divTexts.appendChild(divSkin);

          var enmList = {sm1: [], sm3: [], smW: [], smU: []};

          var imgSkin = document.createElement("img");
          imgSkin.classList = "imgSkin";
          imgSkin.src = `images/skins/${skins[skin]}.jpg`;
          divSkin.appendChild(imgSkin);

          sets[i][skins[skin]].forEach(numEnm => {
            var imgEnm = document.createElement("img");
            imgEnm.classList = "imgEnm";

            var enmType = "";
            if (skin == 1 && numEnm == 2) enmType = "t";
            if (skin == 3 && numEnm == 2) enmType = "u";
            if (skin == 2 && numEnm == 10) enmType = "w";
            if ([2, 3].includes(skin) && numEnm == 8) enmType = "w";

            imgEnm.src = `images/enms/enm${numEnm}${enmType}.jpg`;
            imgEnm.title = skinsEnms[skin][numEnm];
            divSkin.appendChild(imgEnm);

            enmList[skins[skin]].push(skinsEnms[skin][numEnm]);
          });

          imgSkin.title = enmList[skins[skin]];
        }
      }
    }
  </script>


  <hr id="diary">
  <font size="5"><b>雑記</b></font>
  <br><br><font size="2">
  集音配置生成の精度上がりました(はず)。<br>
  なんせ計測なんてする人が少ないので割と大変。
  <br><br>
  データや機能などの誤り, ここに無いグローバル音源配置やスクロール方法, おトクな情報など教えてくれたら嬉しいです。  
  <br><br>
  今年こそSMM3来るかなぁ。
  <br>
  </font>
  <br><br>

  <font size="4"><b>用語と単位集</b></font><br><br>
  <font size="2">
  <b>・f, フレーム</b> ... 
  1/60秒, 観測しうるSMM2の時間最小単位。時間という意味で1f = 1cuである。
  SMM2は60fpsである。<br>

  <b>・b, ブロック幅</b> ... 
  SMM2の1マス。隣接するブロック間の距離は1bとなる。<br>

  <b>・f/b, 遅度</b> ...
  ある距離を進むのにかかる時間。速度の逆数で表される。<br>

  <b>・cu, うるう距離</b> ... 
  羽レールオブジェクトの遅度は(10, 11, 11)f/bという周期で表されるが, レール1本は2bであるのでレール2本と3本で1本あたりにかかる時間が異なるように見える現象, またはその時にズレと認識されているもの。
  これが発生する原因は, 速度0.09375 b/fで1bを割り切れないことにあり, (1b / 0.09375 b/f) = 10.66... f/bとなるのでこれが本来の1b進むのにかかる時間。小数部分は切り捨てなどの処理がされているが, 内部的に小数部分が蓄積して1を超えると現れるのでこのようになる(推測)。
  ループ周期の長さなどを"nうるう距離"と表すこともあるが, 混同を避けるためここでは周期を"n[f]"として表す。
  ややこしい説明だがレール演奏を作成するうえでは, "直線レール3本を曲がらずにつなげると謎の力で1fだけ遅れ, その現象がうるう距離"という認識でも構わない。
  斜めレールなども同じく小数部分の蓄積によりうるう距離が発生する。<br>

  <b>・G, ギャップ</b> ... 
  縦断線レールなどの距離または遅延。<br>

  <b>・R, レール</b> ... 
  レールの本数。ここでは直線レールを指す。<br>

  <b>・終端遅度</b> ... 
  マリオやレールブロックが自由落下し, 充分に加速しきった遅度。1bあたり4f。<br>

  <b>・集音</b> ... 
  レール音符を集めること。また, 集音レールはレール音符を集めるためのレール。<br>

  <b>・着線</b> ... 
  レール音符が落下などして, 集音レールに乗ること。<br>

  <b>・(自由)落下集音</b> ... 
  マリオが自由落下し, 一定の遅度で集音すること。この時レール音符は, マリオと落下遅度が等しいため水平に一列に並ぶ。<br>

  <b>・グローバル</b> ... 
  マリオが同エリアのどこにいても消失・停止しないようなオブジェクトの状態。
  それに近いものを準グローバルといったりする。
  また, オブジェクトをグローバルにすることをグローバル化という。<br>

  <b>・GG, グローバルグラウンド</b> ... 
  グローバルである床。それに接しているオブジェクトもまたグローバルになるが, 離れるとグローバルでなくなる。
  スネークブロックやレール上のオブジェクト(例外あり)などが該当する。<br>

  <b>・座標</b> ... 
  ここでは右向きをx, 上向きをyとする。<br>

  <b>・座標依存性</b> ... 
  エリアの特定の区間とその他では挙動が異なるという現象が見られ, その現象が起こりうるギミックを座標依存性があるという。
  例えば, ↑G1R1-はエリアの形状に依らず y=16~64 付近でその他のエリアより1fだけ早くなることが知られている。
  メカニズムは完全には解明されていないが, 挙動の変化する境目の座標は今のところすべて2^n付近である。
  これはレール演奏のクォリティに影響を与えるため注意が必要(特にループ周期)。<br>

  <b>・ぜんまいメソッド</b> ... 
  zenmaiさんが開発した集音における手法。縦断線レールを通過するのにかかる時間を計測・計算することによって理論的に集音することができる。<br>
  
  <b>・エンティティ, エネミー</b> ... 
  おおむねおんなじ意味。クリボーやキノコ, はたまたレールブロックなど。<br>

  <b>・エンティティリミット</b> ... 
  いわゆる配置制限。ELA, B, Cが定義されているが, ここではそこまで深く扱わない。<br>

  <b>・ELA</b> ... 
  クリボーやレール音符などのオブジェクトの, 作るモードでの配置制限。100個まで。ブロックの中に入っているオブジェクトはカウントされない。<br>

  <b>・ELB</b> ... 
  ELAオブジェクトに加え, 一方通行やスネークブロック, ブロックから出てきたエンティティなどを含め, 遊ぶモードでの制限。これが100以上になるとブロックからELBオブジェクトが生成されなくなる。が, オブジェクトが101個以上存在できないというわけではない。<br>

  <b>・音源の複合</b> ... 
  同時に2つ以上の音源を1つの音符で鳴らすこと。要するに音源エネミーを重ねるだけ。<br>

  ここで定めたものは独自のものであり, ゲーム・数学・物理学・音楽上正しくない, また, 他の人に伝わらない可能性があります。
  </font>
  <br><br>

  <font size="4"><b>役立つかもしれないTips</b></font><br><br>
  <font size="2">
  <b>・アシストロード</b> ...
  <ul>エネミーの足元にリフトなどの読み込み範囲の大きいオブジェクトを配置したり, エネミーを積み重ねたりすることで読み込み範囲を広げられる。<br>
  特に, レール音符ブロックの1マス上にスターを設置すると, 読み込み範囲がy方向に大きく広がることが知られている。</ul>

  <b>・周回型レールループを作るための条件</b> ...
  <ul>断線を含まない周回型(閉じた)レールループでは, 以下が成り立つ(ほぼ自明)。<br>
  (s = 直線の本数, d = 斜めor曲線の本数) 周回型レールループについて, <br>
  ・任意のループ(s, d)において, (s+2, d), (s, d+2)が存在する。<br>
  ・sが奇数のとき, いかなるループも作成できない。<br>
  ・s = 0 のとき, d >= 4, dが偶数 で作成できる。<br>
  ・s = 2 のとき, d >= 1 で作成できる。<br>
  ・s >= 4, sが偶数 のとき, dの値に依らず作成できる。<br></ul>

  <b>・周期168f以上の羽レールループは全て作成可能</b> ...
  <ul>レールループ生成の羽あり特殊を使えば確かめられる。</ul>

  <b>・各レールの長さ</b> ...
  <ul>長さ(レール1本を通過するのにかかる時間)[f]は, <br>
  ・羽あり ... 直線21, 斜め30, 曲線36<br>
  ・羽なし ... 直線42, 斜め60, 曲線71</ul>
  </font>

  <hr>
  <font size="5"><b>参考文献・資料</b></font>
  <font size="2">おいしくいただいております。</font>
  <br><br>
  <font size="3">
  <a href="https://www.youtube.com/watch?v=r1Lp6UY5NIc"><b>ぜんまいメソッド解説</b></a><br>
  <a href="https://www.youtube.com/watch?v=IE5-31xXOFE&list=PLkijGuhvmuKTG2Ve2n2juJwGoFnTa6tLY"><b>レール演奏解説</b></a><br>
  <a href="https://twitter.com/fnjxbf0b5/status/1601536592879161345"><b>レールループ生成</b></a><br>
  <a href="https://www.youtube.com/watch?v=x0NCKZ62eLA"><b>曲線レールについて</b></a><br>
  <a href="https://www.youtube.com/playlist?list=PLJhsrRsHzsa7P2qXlxqRcsxW4mthm-Sw8"><b>ループ演奏の歴史</b></a>
  </font>
  <br><br><br>

  <font size="3"><a href="https://twitter.com/Shamoji_SMM">作った人</a></font><br>
  <font size="2">(C)opyRight 2023 無し</font>

  <script>
    var accelerations = [11, 8, 5, 3, 2, 1, 1];

    var startingList = [
      {delay: 0, display: "↓-", height: 0, up: 0},
      {delay: 14, display: "↓-R1", height: 2, up: 0},
      {delay: 27, display: "↓-R2", height: 4, up: 0},
      {delay: 40, display: "↓-R3", height: 6, up: 0},
      {delay: 54, display: "↓-R4", height: 8, up: 0},
      {delay: 67, display: "↓-R5", height: 10, up: 0},
      {delay: 80, display: "↓-R6", height: 12, up: 0},

      {delay: 21, display: "↑R0-", height: 0, up: 0},
      {delay: 34, display: "↑R0-R1", height: 2, up: 0},
      {delay: 48, display: "↑R0-R2", height: 4, up: 0},
      {delay: 61, display: "↑R0-R3", height: 6, up: 0},
      {delay: 74, display: "↑R0-R4", height: 8, up: 0},
      {delay: 88, display: "↑R0-R5", height: 10, up: 0},
      {delay: 101, display: "↑R0-R6", height: 12, up: 0},

      {delay: 64, display: "↑R1-", height: 0, up: 2},
      {delay: 78, display: "↑R1-R1", height: 2, up: 2},
      {delay: 91, display: "↑R1-R2", height: 4, up: 2},
      {delay: 104, display: "↑R1-R3", height: 6, up: 2},
      {delay: 118, display: "↑R1-R4", height: 8, up: 2},
      {delay: 131, display: "↑R1-R5", height: 10, up: 2},
      {delay: 144, display: "↑R1-R6", height: 12, up: 2},

      {delay: 82, display: "↑G1R1-", height: 0, up: 3},
      {delay: 95, display: "↑G1R1-R1", height: 2, up: 3},
      {delay: 108, display: "↑G1R1-R2", height: 4, up: 3},
      {delay: 122, display: "↑G1R1-R3", height: 6, up: 3},
      {delay: 135, display: "↑G1R1-R4", height: 8, up: 3},
      {delay: 148, display: "↑G1R1-R5", height: 10, up: 3},
      {delay: 162, display: "↑G1R1-R6", height: 12, up: 3},

      {delay: 98, display: "↑G2R1-", height: 0, up: 4},
      {delay: 112, display: "↑G2R1-R1", height: 2, up: 4},
      {delay: 125, display: "↑G2R1-R2", height: 4, up: 4},
      {delay: 138, display: "↑G2R1-R3", height: 6, up: 4},
      {delay: 152, display: "↑G2R1-R4", height: 8, up: 4},
      {delay: 165, display: "↑G2R1-R5", height: 10, up: 4},
      {delay: 178, display: "↑G2R1-R6", height: 12, up: 4},

      {delay: 107, display: "↑R2-", height: 0, up: 4},
      {delay: 120, display: "↑R2-R1", height: 2, up: 4},
      {delay: 133, display: "↑R2-R2", height: 4, up: 4},
      {delay: 147, display: "↑R2-R3", height: 6, up: 4},
      {delay: 160, display: "↑R2-R4", height: 8, up: 4},
      {delay: 173, display: "↑R2-R5", height: 10, up: 4},
      {delay: 187, display: "↑R2-R6", height: 12, up: 4},

      {delay: 111, display: "↑F-", height: 0, up: 0},
      {delay: 124, display: "↑F-R1", height: 2, up: 0},
      {delay: 137, display: "↑F-R2", height: 4, up: 0},
      {delay: 151, display: "↑F-R3", height: 6, up: 0},
      {delay: 164, display: "↑F-R4", height: 8, up: 0},
      {delay: 177, display: "↑F-R5", height: 10, up: 0},
      {delay: 191, display: "↑F-R6", height: 12, up: 0},

      {delay: 120, display: "↑G3R1-", height: 0, up: 5},
      {delay: 133, display: "↑G3R1-R1", height: 2, up: 5},
      {delay: 146, display: "↑G3R1-R2", height: 4, up: 5},
      {delay: 160, display: "↑G3R1-R3", height: 6, up: 5},
      {delay: 173, display: "↑G3R1-R4", height: 8, up: 5},
      {delay: 186, display: "↑G3R1-R5", height: 10, up: 5},
      {delay: 200, display: "↑G3R1-R6", height: 12, up: 5},

      {delay: 124, display: "↑G1R2-", height: 0, up: 5},
      {delay: 137, display: "↑G1R2-R1", height: 2, up: 5},
      {delay: 150, display: "↑G1R2-R2", height: 4, up: 5},
      {delay: 164, display: "↑G1R2-R3", height: 6, up: 5},
      {delay: 177, display: "↑G1R2-R4", height: 8, up: 5},
      {delay: 190, display: "↑G1R2-R5", height: 10, up: 5},
      {delay: 204, display: "↑G1R2-R6", height: 12, up: 5},

      {delay: 125, display: "↑R1G1R1-", height: 0, up: 5},
      {delay: 138, display: "↑R1G1R1-R1", height: 2, up: 5},
      {delay: 152, display: "↑R1G1R1-R2", height: 4, up: 5},
      {delay: 165, display: "↑R1G1R1-R3", height: 6, up: 5},
      {delay: 178, display: "↑R1G1R1-R4", height: 8, up: 5},
      {delay: 192, display: "↑R1G1R1-R5", height: 10, up: 5},
      {delay: 205, display: "↑R1G1R1-R6", height: 12, up: 5},

      {delay: 140, display: "↑G2R2-", height: 0, up: 6},
      {delay: 154, display: "↑G2R2-R1", height: 2, up: 6},
      {delay: 167, display: "↑G2R2-R2", height: 4, up: 6},
      {delay: 180, display: "↑G2R2-R3", height: 6, up: 6},
      {delay: 194, display: "↑G2R2-R4", height: 8, up: 6},
      {delay: 207, display: "↑G2R2-R5", height: 10, up: 6},
      {delay: 220, display: "↑G2R2-R6", height: 12, up: 6},

      {delay: 149, display: "↑R3-", height: 0, up: 6},
      {delay: 162, display: "↑R3-R1", height: 2, up: 6},
      {delay: 176, display: "↑R3-R2", height: 4, up: 6},
      {delay: 189, display: "↑R3-R3", height: 6, up: 6},
      {delay: 202, display: "↑R3-R4", height: 8, up: 6},
      {delay: 216, display: "↑R3-R5", height: 10, up: 6},
      {delay: 229, display: "↑R3-R6", height: 12, up: 6},

      {delay: 159, display: "↑G1R1G2R1-", height: 0, up: 7},
      {delay: 172, display: "↑G1R1G2R1-R1", height: 2, up: 7},
      {delay: 185, display: "↑G1R1G2R1-R2", height: 4, up: 7},
      {delay: 199, display: "↑G1R1G2R1-R3", height: 6, up: 7},
      {delay: 212, display: "↑G1R1G2R1-R4", height: 8, up: 7},
      {delay: 225, display: "↑G1R1G2R1-R5", height: 10, up: 7},
      {delay: 239, display: "↑G1R1G2R1-R6", height: 12, up: 7},

      {delay: 159, display: "↑G2R1G1R1-", height: 0, up: 7},
      {delay: 173, display: "↑G2R1G1R1-R1", height: 2, up: 7},
      {delay: 185, display: "↑G2R1G1R1-R2", height: 4, up: 7},
      {delay: 199, display: "↑G2R1G1R1-R3", height: 6, up: 7},
      {delay: 213, display: "↑G2R1G1R1-R4", height: 8, up: 7},
      {delay: 226, display: "↑G2R1G1R1-R5", height: 10, up: 7},
      {delay: 239, display: "↑G2R1G1R1-R6", height: 12, up: 7},

      {delay: 162, display: "↑G3R2-", height: 0, up: 7},
      {delay: 175, display: "↑G3R2-R1", height: 2, up: 7},
      {delay: 188, display: "↑G3R2-R2", height: 4, up: 7},
      {delay: 202, display: "↑G3R2-R3", height: 6, up: 7},
      {delay: 215, display: "↑G3R2-R4", height: 8, up: 7},
      {delay: 228, display: "↑G3R2-R5", height: 10, up: 7},
      {delay: 243, display: "↑G3R2-R6", height: 12, up: 7},

      {delay: 163, display: "↑R1G3R1-", height: 0, up: 7},
      {delay: 176, display: "↑R1G3R1-R1", height: 2, up: 7},
      {delay: 190, display: "↑R1G3R1-R2", height: 4, up: 7},
      {delay: 203, display: "↑R1G3R1-R3", height: 6, up: 7},
      {delay: 216, display: "↑R1G3R1-R4", height: 8, up: 7},
      {delay: 230, display: "↑R1G3R1-R5", height: 10, up: 7},
      {delay: 244, display: "↑R1G3R1-R6", height: 12, up: 7},

      {delay: 154, display: "↑R1F-", height: 0, up: 2},
      {delay: 167, display: "↑R1F-R1", height: 2, up: 2},
      {delay: 181, display: "↑R1F-R2", height: 4, up: 2},
      {delay: 194, display: "↑R1F-R3", height: 6, up: 2},
      {delay: 207, display: "↑R1F-R4", height: 8, up: 2},
      {delay: 221, display: "↑R1F-R5", height: 10, up: 2},
      {delay: 234, display: "↑R1F-R6", height: 12, up: 2},

      {delay: 142, display: "↑R1G2R1-", height: 0, up: 6},
      {delay: 155, display: "↑R1G2R1-R1", height: 2, up: 6},
      {delay: 168, display: "↑R1G2R1-R2", height: 4, up: 6},
      {delay: 182, display: "↑R1G2R1-R3", height: 6, up: 6},
      {delay: 195, display: "↑R1G2R1-R4", height: 8, up: 6},
      {delay: 208, display: "↑R1G2R1-R5", height: 10, up: 6},
      {delay: 222, display: "↑R1G2R1-R6", height: 12, up: 6},

      {delay: 167, display: "↑G1R3-", height: 0, up: 7},
      {delay: 180, display: "↑G1R3-R1", height: 2, up: 7},
      {delay: 193, display: "↑G1R3-R2", height: 4, up: 7},
      {delay: 207, display: "↑G1R3-R3", height: 6, up: 7},
      {delay: 220, display: "↑G1R3-R4", height: 8, up: 7},
      {delay: 233, display: "↑G1R3-R5", height: 10, up: 7},
      {delay: 247, display: "↑G1R3-R6", height: 12, up: 7},

      {delay: 175, display: "↑G2R1G2R1-", height: 0, up: 8},
      {delay: 189, display: "↑G2R1G2R1-R1", height: 2, up: 8},
      {delay: 202, display: "↑G2R1G2R1-R2", height: 4, up: 8},
      {delay: 215, display: "↑G2R1G2R1-R3", height: 6, up: 8},
      {delay: 229, display: "↑G2R1G2R1-R4", height: 8, up: 8},
      {delay: 242, display: "↑G2R1G2R1-R5", height: 10, up: 8},
      {delay: 255, display: "↑G2R1G2R1-R6", height: 12, up: 8},

      {delay: 167, display: "↑R1G1R2-", height: 0, up: 5},
      {delay: 180, display: "↑R1G1R2-R1", height: 2, up: 5},
      {delay: 194, display: "↑R1G1R2-R2", height: 4, up: 5},
      {delay: 207, display: "↑R1G1R2-R3", height: 6, up: 5},
      {delay: 220, display: "↑R1G1R2-R4", height: 8, up: 5},
      {delay: 234, display: "↑R1G1R2-R5", height: 10, up: 5},
      {delay: 247, display: "↑R1G1R2-R6", height: 12, up: 5},

      {delay: 167, display: "↑R2G1R1-", height: 0, up: 5},
      {delay: 181, display: "↑R2G1R1-R1", height: 2, up: 5},
      {delay: 194, display: "↑R2G1R1-R2", height: 4, up: 5},
      {delay: 207, display: "↑R2G1R1-R3", height: 6, up: 5},
      {delay: 221, display: "↑R2G1R1-R4", height: 8, up: 5},
      {delay: 234, display: "↑R2G1R1-R5", height: 10, up: 5},
      {delay: 247, display: "↑R2G1R1-R6", height: 12, up: 5},

      {delay: 172, display: "↑G1R1F-", height: 0, up: 3},
      {delay: 185, display: "↑G1R1F-R1", height: 2, up: 3},
      {delay: 198, display: "↑G1R1F-R2", height: 4, up: 3},
      {delay: 212, display: "↑G1R1F-R3", height: 6, up: 3},
      {delay: 225, display: "↑G1R1F-R4", height: 8, up: 3},
      {delay: 238, display: "↑G1R1F-R5", height: 10, up: 3},
      {delay: 252, display: "↑G1R1F-R6", height: 12, up: 3},

      {delay: 184, display: "↑G2R3-", height: 0, up: 8},
      {delay: 198, display: "↑G2R3-R1", height: 2, up: 8},
      {delay: 211, display: "↑G2R3-R2", height: 4, up: 8},
      {delay: 224, display: "↑G2R3-R3", height: 6, up: 8},
      {delay: 238, display: "↑G2R3-R4", height: 8, up: 8},
      {delay: 251, display: "↑G2R3-R5", height: 10, up: 8},
      {delay: 264, display: "↑G2R3-R6", height: 12, up: 8},

      {delay: 184, display: "↑R1G2R2-", height: 0, up: 8},
      {delay: 197, display: "↑R1G2R2-R1", height: 2, up: 8},
      {delay: 210, display: "↑R1G2R2-R2", height: 4, up: 8},
      {delay: 224, display: "↑R1G2R2-R3", height: 6, up: 8},
      {delay: 237, display: "↑R1G2R2-R4", height: 8, up: 8},
      {delay: 250, display: "↑R1G2R2-R5", height: 10, up: 8},
      {delay: 264, display: "↑R1G2R2-R6", height: 12, up: 8},

      {delay: 184, display: "↑R2G2R1-", height: 0, up: 8},
      {delay: 197, display: "↑R2G2R1-R1", height: 2, up: 8},
      {delay: 211, display: "↑R2G2R1-R2", height: 4, up: 8},
      {delay: 224, display: "↑R2G2R1-R3", height: 6, up: 8},
      {delay: 237, display: "↑R2G2R1-R4", height: 8, up: 8},
      {delay: 251, display: "↑R2G2R1-R5", height: 10, up: 8},
      {delay: 264, display: "↑R2G2R1-R6", height: 12, up: 8},

      {delay: 196, display: "↑R2F-", height: 0, up: 4},
      {delay: 210, display: "↑R2F-R1", height: 2, up: 4},
      {delay: 223, display: "↑R2F-R2", height: 4, up: 4},
      {delay: 236, display: "↑R2F-R3", height: 6, up: 4},
      {delay: 250, display: "↑R2F-R4", height: 8, up: 4},
      {delay: 263, display: "↑R2F-R5", height: 10, up: 4},
      {delay: 276, display: "↑R2F-R6", height: 12, up: 4},

      {delay: 192, display: "↑R4-", height: 0, up: 8},
      {delay: 206, display: "↑R4-R1", height: 2, up: 8},
      {delay: 219, display: "↑R4-R2", height: 4, up: 8},
      {delay: 232, display: "↑R4-R3", height: 6, up: 8},
      {delay: 246, display: "↑R4-R4", height: 8, up: 8},
      {delay: 259, display: "↑R4-R5", height: 10, up: 8},
      {delay: 272, display: "↑R4-R6", height: 12, up: 8},

      {delay: 235, display: "↑R5-", height: 0, up: 10},
      {delay: 248, display: "↑R5-R1", height: 2, up: 10},
      {delay: 261, display: "↑R5-R2", height: 4, up: 10},
      {delay: 275, display: "↑R5-R3", height: 6, up: 10},
      {delay: 288, display: "↑R5-R4", height: 8, up: 10},
      {delay: 301, display: "↑R5-R5", height: 10, up: 10},
      {delay: 315, display: "↑R5-R6", height: 12, up: 10},

      {delay: 197, display: "↑G2R1G3R1-", height: 0, up: 9},
      {delay: 211, display: "↑G2R1G3R1-R1", height: 2, up: 9},
      {delay: 224, display: "↑G2R1G3R1-R2", height: 4, up: 9},
      {delay: 237, display: "↑G2R1G3R1-R3", height: 6, up: 9},
      {delay: 251, display: "↑G2R1G3R1-R4", height: 8, up: 9},
      {delay: 264, display: "↑G2R1G3R1-R5", height: 10, up: 9},
      {delay: 277, display: "↑G2R1G3R1-R6", height: 12, up: 9},

      {delay: 197, display: "↑G3R1G2R1-", height: 0, up: 9},
      {delay: 210, display: "↑G3R1G2R1-R1", height: 2, up: 9},
      {delay: 223, display: "↑G3R1G2R1-R2", height: 4, up: 9},
      {delay: 237, display: "↑G3R1G2R1-R3", height: 6, up: 9},
      {delay: 250, display: "↑G3R1G2R1-R4", height: 8, up: 9},
      {delay: 263, display: "↑G3R1G2R1-R5", height: 10, up: 9},
      {delay: 277, display: "↑G3R1G2R1-R6", height: 12, up: 9},

      {delay: 239, display: "↑R3F-", height: 0, up: 6},
      {delay: 252, display: "↑R3F-R1", height: 2, up: 6},
      {delay: 265, display: "↑R3F-R2", height: 4, up: 6},
      {delay: 279, display: "↑R3F-R3", height: 6, up: 6},
      {delay: 292, display: "↑R3F-R4", height: 8, up: 6},
      {delay: 305, display: "↑R3F-R5", height: 10, up: 6},
      {delay: 319, display: "↑R3F-R6", height: 12, up: 6},

      {delay: 188, display: "↑G2R1F-", height: 0, up: 4},
      {delay: 202, display: "↑G2R1F-R1", height: 2, up: 4},
      {delay: 215, display: "↑G2R1F-R2", height: 4, up: 4},
      {delay: 228, display: "↑G2R1F-R3", height: 6, up: 4},
      {delay: 242, display: "↑G2R1F-R4", height: 8, up: 4},
      {delay: 255, display: "↑G2R1F-R5", height: 10, up: 4},
      {delay: 268, display: "↑G2R1F-R6", height: 12, up: 4},

      {delay: 210, display: "↑G3R1F-", height: 0, up: 5},
      {delay: 223, display: "↑G3R1F-R1", height: 2, up: 5},
      {delay: 236, display: "↑G3R1F-R2", height: 4, up: 5},
      {delay: 250, display: "↑G3R1F-R3", height: 6, up: 5},
      {delay: 263, display: "↑G3R1F-R4", height: 8, up: 5},
      {delay: 276, display: "↑G3R1F-R5", height: 10, up: 5},
      {delay: 290, display: "↑G3R1F-R6", height: 12, up: 5},

      {delay: 202, display: "↑G1R2G2R1-", height: 0, up: 9},
      {delay: 215, display: "↑G1R2G2R1-R1", height: 2, up: 9},
      {delay: 228, display: "↑G1R2G2R1-R2", height: 4, up: 9},
      {delay: 242, display: "↑G1R2G2R1-R3", height: 6, up: 9},
      {delay: 255, display: "↑G1R2G2R1-R4", height: 8, up: 9},
      {delay: 268, display: "↑G1R2G2R1-R5", height: 10, up: 9},
      {delay: 282, display: "↑G1R2G2R1-R6", height: 12, up: 9},

      {delay: 202, display: "↑G2R1G1R2-", height: 0, up: 9},
      {delay: 216, display: "↑G2R1G1R2-R1", height: 2, up: 9},
      {delay: 229, display: "↑G2R1G1R2-R2", height: 4, up: 9},
      {delay: 242, display: "↑G2R1G1R2-R3", height: 6, up: 9},
      {delay: 256, display: "↑G2R1G1R2-R4", height: 8, up: 9},
      {delay: 269, display: "↑G2R1G1R2-R5", height: 10, up: 9},
      {delay: 282, display: "↑G2R1G1R2-R6", height: 12, up: 9},

      {delay: 205, display: "↑G3R3-", height: 0, up: 9},
      {delay: 218, display: "↑G3R3-R1", height: 2, up: 9},
      {delay: 231, display: "↑G3R3-R2", height: 4, up: 9},
      {delay: 245, display: "↑G3R3-R3", height: 6, up: 9},
      {delay: 258, display: "↑G3R3-R4", height: 8, up: 9},
      {delay: 271, display: "↑G3R3-R5", height: 10, up: 9},
      {delay: 285, display: "↑G3R3-R6", height: 12, up: 9},

      {delay: 205, display: "↑R1G3R2-", height: 0, up: 9},
      {delay: 218, display: "↑R1G3R2-R1", height: 2, up: 9},
      {delay: 232, display: "↑R1G3R2-R2", height: 4, up: 9},
      {delay: 245, display: "↑R1G3R2-R3", height: 6, up: 9},
      {delay: 258, display: "↑R1G3R2-R4", height: 8, up: 9},
      {delay: 272, display: "↑R1G3R2-R5", height: 10, up: 9},
      {delay: 285, display: "↑R1G3R2-R6", height: 12, up: 9},

      {delay: 205, display: "↑R2G3R1-", height: 0, up: 9},
      {delay: 219, display: "↑R2G3R1-R1", height: 2, up: 9},
      {delay: 232, display: "↑R2G3R1-R2", height: 4, up: 9},
      {delay: 245, display: "↑R2G3R1-R3", height: 6, up: 9},
      {delay: 259, display: "↑R2G3R1-R4", height: 8, up: 9},
      {delay: 272, display: "↑R2G3R1-R5", height: 10, up: 9},
      {delay: 285, display: "↑R2G3R1-R6", height: 12, up: 9},

      {delay: 210, display: "↑R1G1R3-", height: 0, up: 9},
      {delay: 223, display: "↑R1G1R3-R1", height: 2, up: 9},
      {delay: 237, display: "↑R1G1R3-R2", height: 4, up: 9},
      {delay: 250, display: "↑R1G1R3-R3", height: 6, up: 9},
      {delay: 263, display: "↑R1G1R3-R4", height: 8, up: 9},
      {delay: 277, display: "↑R1G1R3-R5", height: 10, up: 9},
      {delay: 290, display: "↑R1G1R3-R6", height: 12, up: 9},

      {delay: 209, display: "↑R2G1R2-", height: 0, up: 9},
      {delay: 223, display: "↑R2G1R2-R1", height: 2, up: 9},
      {delay: 236, display: "↑R2G1R2-R2", height: 4, up: 9},
      {delay: 249, display: "↑R2G1R2-R3", height: 6, up: 9},
      {delay: 263, display: "↑R2G1R2-R4", height: 8, up: 9},
      {delay: 276, display: "↑R2G1R2-R5", height: 10, up: 9},
      {delay: 289, display: "↑R2G1R2-R6", height: 12, up: 9},

      {delay: 214, display: "↑G1R2F-", height: 0, up: 5},
      {delay: 227, display: "↑G1R2F-R1", height: 2, up: 5},
      {delay: 240, display: "↑G1R2F-R2", height: 4, up: 5},
      {delay: 254, display: "↑G1R2F-R3", height: 6, up: 5},
      {delay: 267, display: "↑G1R2F-R4", height: 8, up: 5},
      {delay: 280, display: "↑G1R2F-R5", height: 10, up: 5},
      {delay: 294, display: "↑G1R2F-R6", height: 12, up: 5},

      {delay: 230, display: "↑G2R2F-", height: 0, up: 6},
      {delay: 244, display: "↑G2R2F-R1", height: 2, up: 6},
      {delay: 257, display: "↑G2R2F-R2", height: 4, up: 6},
      {delay: 270, display: "↑G2R2F-R3", height: 6, up: 6},
      {delay: 284, display: "↑G2R2F-R4", height: 8, up: 6},
      {delay: 297, display: "↑G2R2F-R5", height: 10, up: 6},
      {delay: 310, display: "↑G2R2F-R6", height: 12, up: 6},

      {delay: 232, display: "↑R1G2R1F-", height: 0, up: 6},
      {delay: 245, display: "↑R1G2R1F-R1", height: 2, up: 6},
      {delay: 258, display: "↑R1G2R1F-R2", height: 4, up: 6},
      {delay: 272, display: "↑R1G2R1F-R3", height: 6, up: 6},
      {delay: 285, display: "↑R1G2R1F-R4", height: 8, up: 6},
      {delay: 298, display: "↑R1G2R1F-R5", height: 10, up: 6},
      {delay: 312, display: "↑R1G2R1F-R6", height: 12, up: 6}
    ];

    var gapList = [
      {delay: 0, display: "", height: 0},

      {delay: 19, display: "G1R1", height: 3},
      {delay: 32, display: "G1R2", height: 5},
      {delay: 45, display: "G1R3", height: 7},
      {delay: 59, display: "G1R4", height: 9},
      {delay: 72, display: "G1R5", height: 11},

      {delay: 22, display: "G2R1", height: 4},
      {delay: 36, display: "G2R2", height: 6},
      {delay: 49, display: "G2R3", height: 8},
      {delay: 62, display: "G2R4", height: 10},
      {delay: 76, display: "G2R5", height: 12},

      {delay: 25, display: "G3R1", height: 5},
      {delay: 38, display: "G3R2", height: 7},
      {delay: 51, display: "G3R3", height: 9},
      {delay: 65, display: "G3R4", height: 11},

      {delay: 26, display: "G4R1", height: 6},
      {delay: 40, display: "G4R2", height: 8},
      {delay: 53, display: "G4R3", height: 10},
      {delay: 66, display: "G4R4", height: 12},

      {delay: 28, display: "G5R1", height: 7},
      {delay: 41, display: "G5R2", height: 9},
      {delay: 54, display: "G5R3", height: 11},

      {delay: 28, display: "G6R1", height: 8},
      {delay: 42, display: "G6R2", height: 10},
      {delay: 55, display: "G6R3", height: 12},

      {delay: 30, display: "G7R1", height: 9},
      {delay: 43, display: "G7R2", height: 11},
      {delay: 56, display: "G7R3", height: 13},

      {delay: 29, display: "G8R1", height: 10},
      {delay: 42, display: "G8R2", height: 12},
      {delay: 56, display: "G8R3", height: 14}
    ];
  
    var commonEnms = ["チョロプー", "ガボン", "ボムへい", "メカクッパ", "ミサイルメカクッパ(赤メカクッパ)", "ビームメカクッパ(青メカクッパ)", "クッパJr.", "ハナチャン", "ハンマーブロス", "メガブロス", "サンボ", "カメック", "プー", "トゲメット", "緑ノコノコ", "赤ノコノコ", "カロン", "メット", "トゲメット", "カロンこうら", "メットこうら", "トゲメットこうら", "杭なしワンワン", "ブラックパックン", "POWブロック", "Pスイッチ", "縦ジャンプ台(縦バネ)", "横ジャンプ台(横バネ)", "砲台", "キラー砲台", "ドッスン", "クッパ", "ブンブン", "ラリー", "イギー", "ウェンディ", "レミー", "ロイ", "モートン", "ルドウィッグ", "ワンワンの杭"];
    
    var sm1Enms = ["スーパーキノコ", "1UPキノコ", "マリオUSAのキノコ(USAキノコ)", "スーパースター", "ファイアフラワー", "スーパーボールフラワー", "マスターソード", "でかキノコ", "くつクリボー", "クイーンくつクリボー", "パックンフラワー", "ファイアパックン", "クッパクラウン", "クリボー", "カキボー"].concat(commonEnms);
    var sm3Enms = ["スーパーキノコ", "1UPキノコ", "カエルスーツ", "スーパースター", "ファイアフラワー", "-", "-", "-", "くつクリボー", "クイーンくつクリボー", "パックンフラワー", "ファイアパックン", "クッパクラウン", "クリボー", "カキボー"].concat(commonEnms);
    var smWEnms = ["スーパーキノコ", "1UPキノコ", "-", "スーパースター", "ファイアフラワー", "-", "-", "-", "ヨッシー", "-", "ピーパックン", "ファイアパックン", "クッパクラウン", "クリボン", "カキボン"].concat(commonEnms);
    var smUEnms = ["スーパーキノコ", "1UPキノコ", "スーパードングリ", "スーパースター", "ファイアフラワー", "-", "-", "-", "ヨッシー", "-", "パックンフラワー", "ファイアパックン", "クッパクラウン", "クリボー", "カキボー"].concat(commonEnms);
    
    var skins = ["sm1", "sm3", "smW", "smU"];
    var skinsEnms = [sm1Enms, sm3Enms, smWEnms, smUEnms];

    var sets = [
      {
        cost: 0,
        combine: false,
        sm1: [8, 9, 29, 30, 31, 33, 37],
        sm3: [8, 9, 29, 30, 31, 33, 37],
        smW: [29, 30, 31, 33, 37],
        smU: [33, 37],
        note: "これらの音源を単体で使いたいならこれが一番。"
      },
      {
        cost: 0,
        combine: false,
        sm1: [29, 30, 31],
        sm3: [29, 30, 31],
        smW: [29, 30, 31],
        smU: [],
        note: "ノコノコ系のみ。smUで使えないのはたぶん背が高いせいの可能性が高い。"
      },
      {
        cost: 0,
        combine: false,
        sm1: [10, 11],
        sm3: [10, 11],
        smW: [11],
        smU: [10, 11],
        note: "オーソドックスなパックン音源。"
      },
      {
        cost: 0,
        combine: false,
        sm1: [41],
        sm3: [41],
        smW: [41],
        smU: [41],
        note: "ドラム系で唯一音符ブロックに埋め込んでグローバルになる。近くだとうるさい。"
      },
      {
        cost: 0,
        combine: false,
        sm1: [38],
        sm3: [38],
        smW: [38],
        smU: [38],
        note: "ブラパ単体のグローバル化だとコンベアと坂を用いた手法が主流だけどこれの方がコンパクト。"
      },
      {
        cost: 0,
        combine: false,
        sm1: [25],
        sm3: [25],
        smW: [25],
        smU: [25],
        note: "白音符ブロックを使用するため近くだと雑音あり。音の間隔が短いと鳴らなかったり壊れたり。"
      },
      {
        cost: 1,
        combine: false,
        sm1: [24],
        sm3: [24],
        smW: [24],
        smU: [],
        note: "たつまきを使用してメガブロスにジャンプさせない。smUは少し違う配置。"
      },
      {
        cost: 1,
        combine: false,
        sm1: [],
        sm3: [],
        smW: [],
        smU: [24],
        note: "これはその他のスキンよりもコンパクトにできる。"
      },
      {
        cost: 0,
        combine: false,
        sm1: [23],
        sm3: [23],
        smW: [23],
        smU: [23],
        note: "空中飛ばしを活用してソフトタッチ(?)。スペースはとるけどスネークブロック不使用で環境と財布にやさしい。"
      },
      {
        cost: 0,
        combine: false,
        sm1: [0, 1, 2, 3, 4, 5, 6, 7],
        sm3: [0, 1, 2, 3, 4],
        smW: [0, 1, 3, 4],
        smU: [0, 1, 2, 3, 4],
        note: "古典的な坂を使った押さえつけ。下からは無理でも横からなら。"
      },
      {
        cost: 2,
        combine: false,
        sm1: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37, 46, 47],
        sm3: [0, 1, 2, 3, 4, 8, 9, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37, 46, 47],
        smW: [0, 1, 3, 4, 8, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37, 46, 47],
        smU: [0, 1, 2, 3, 4, 8, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37, 47],
        note: "だいたいなんでもいける。クレーンを動かすことで複合できる。プレイヤーが近づくとPOWを放してしまうので注意。"
      },
      {
        cost: 2,
        combine: true,
        sm1: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37, 46, 47],
        sm3: [0, 1, 2, 3, 4, 8, 9, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37, 46, 47],
        smW: [0, 1, 3, 4, 8, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37, 46, 47],
        smU: [0, 1, 2, 3, 4, 8, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37, 47],
        note: "複合可能なものとしては最も広く使われているであろう配置。高コストに目を瞑れば便利。プレイヤーが近づくとPOWを放してしまうので注意。"
      },
      {
        cost: 0,
        combine: true,
        sm1: [7, 13, 15, 16, 17, 18, 21, 22],
        sm3: [13, 15, 16, 17, 18, 21, 22],
        smW: [13, 15, 16, 17, 18, 21, 22],
        smU: [7, 13, 15, 16, 17, 18, 21, 22, 29],
        note: "ほぼ同じ性質を持っているはずのカキボーや異色メカクッパ, 異色ノコノコは使えたり使えなかったり。音の間隔が短いと鳴らなかったり壊れたり。"
      },
      {
        cost: 0,
        combine: true,
        sm1: [0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 23, 34, 36],
        sm3: [0, 1, 2, 3, 4, 8, 9, 10, 11, 23, 34, 36],
        smW: [0, 1, 3, 4, 8, 10, 11, 23, 34, 36],
        smU: [0, 1, 2, 3, 4, 8, 10, 11, 23, 34, 36],
        note: "大ブラパに埋め込み。いろんな音符の当て方ができる。クリボーやメカクッパ, ノコノコなどもできるのだが埋め込みが安定しないため除外してある。"
      },
      {
        cost: 0,
        combine: true,
        sm1: [0, 1, 2, 3, 4, 5, 6, 8, 9, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 29, 30, 31, 32, 33, 34, 35, 36, 37],
        sm3: [0, 1, 2, 3, 4, 8, 9, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 29, 30, 31, 32, 33, 34, 35, 36, 37],
        smW: [0, 1, 3, 4, 8, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 29, 30, 31, 32, 33, 34, 35, 36, 37],
        smU: [0, 1, 2, 3, 4, 8, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 29, 30, 31, 32, 33, 34, 35, 36, 37],
        note: "これも埋め込みであるため下から以外なら少々乱暴に扱ってもOK。とても汎用性が高く便利。"
      },
      {
        cost: 1,
        combine: true,
        sm1: [0, 1, 2, 3, 4, 5, 6, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23],
        sm3: [0, 1, 2, 3, 4, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23],
        smW: [0, 1, 3, 4, 8, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23],
        smU: [0, 1, 2, 3, 4, 8, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 29, 30, 31],
        note: "たつまき不使用verに比べてコストが上がっているが, ハンマーブロス(かクッパJr.)を使う場合はスタックしなくていいので全体的にコストが下がる。注意として, アイテムやヨッシーのみでは使えず他の敵エネミーと一緒に使う必要がある(アイテムのみなら別の方法の方がいいけど)。"
      },
      {
        cost: 2,
        combine: false,
        sm1: [38, 39, 40, 41, 42, 43, 44, 55],
        sm3: [38, 39, 40, 41, 42, 43, 44, 55],
        smW: [38, 39, 40, 41, 42, 43, 44, 55],
        smU: [38, 39, 40, 41, 42, 43, 44, 55],
        note: "スイッチで切り替えられるドラム。POW, 縦バネ, ブラパでうまくいかない時は一番下の砲台を大ブラパに変えるとよい。"
      },
      {
        cost: 1,
        combine: false,
        sm1: [0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37],
        sm3: [0, 1, 2, 3, 4, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37],
        smW: [0, 1, 3, 4, 8, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37],
        smU: [0, 1, 2, 3, 4, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 29, 30, 31, 32, 33, 34, 35, 36, 37],
        note: "だいたいなんでもいける。音源ELAの節約と複合ができないのが玉に瑕。"
      }
    ];
  </script>
</body>
</html>
